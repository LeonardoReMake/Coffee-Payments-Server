# Изменение системы логирования в проекте

## 1. Общая задача

Необходимо обновить конфигурацию логирования в проекте так, чтобы она соответствовала требованиям продового окружения и была совместима с лог-агрегацией Kubernetes.

---

## 2. Требования к новой системе логирования

### 2.1. Логи — только в stdout/stderr

- Удалить запись логов в файловые хендлеры.
- Убрать любые ссылки на file handlers в Django logging settings.
- Все логи должны выводиться **только** в консоль:
  - `stdout` для обычных логов,
  - `stderr` для ошибок.

Это должно работать для:

- Django (root logger)
- DRF
- Celery
- Любых пользовательских логгеров

---

### 2.2. Формат root-логов — JSON

Root-логгер должен использовать **уже существующий JSON-формат логирования**, который применяется в проекте.

Требования:

- JSONFormatter должен быть установлен по умолчанию на root logger.
- Все child-логгеры должны наследовать формат JSON.
- Никаких plain/text логов.

---

### 2.3. Единая ENV-переменная для уровня логирования

Добавить новую переменную окружения:

### `LOG_LEVEL`

- Управляет уровнем логирования **для всех логгеров сразу**.
- Возможные значения:
  - `DEBUG`
  - `INFO`
  - `WARNING`
  - `ERROR`
  - `CRITICAL`
- Значение по умолчанию: `INFO` (если в проекте не задано другое).

Должно применяться к:

- root logger
- Django loggers
- Celery loggers
- Пользовательским логгерам

---

## 3. Что необходимо обновить в проекте

1. Переписать `LOGGING` в Django settings:
   - удалить file handlers
   - оставить только console handler
   - установить JSON formatter
   - уровень root logger = `LOG_LEVEL`

2. Проверить, что Celery использует Django logging config.

3. Убедиться, что дополнительные логгеры (например, для платежных систем, TMetr API и т.д.) не переопределяют handler'ы.

4. Обновить README.md:
   - добавить описание переменной `LOG_LEVEL`

5. Убрать создание папки для логов из docker файлов

---

## 4. Итоговый ожидаемый результат (MVP)

- Вся система логирования работает только через stdout/stderr.
- Формат логов — JSON, единый для всех сервисов.
- Уровень логирования централизованно задаётся через ENV (`LOG_LEVEL`).
- Система полностью совместима с Kubernetes + Loki/ELK/CloudWatch.

## 5. Обнови описание проекта в PROJECT.md
 - Обнови описание проекта в PROJECT.md
 - При разработки учитывай CONSTITUTUON.md